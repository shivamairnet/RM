<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <!-- <link rel="stylesheet" href="customer-not-found.css" /> -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,600,0,0"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
  </head>
  <style>
    * {
      padding: 0;
      font-family: Calibri, "Trebuchet MS", sans-serif;
    }
    .btn1:hover {
      background-color: #ff4040;
      color: white !important;
    }
    .btn2:hover {
      background-color: green;
      color: white !important;
    }
    .btn3:hover {
      background-color: #2f3268 !important;
      color: white !important;
    }
    .btn4:hover {
      background-color: #ff4040;
      color: white !important;
    }
  </style>

  <body>
    <div class="w-100 p-5" style="background-color: rgb(245, 244, 244)">
      <div
        class="conatiner d-flex flex-column justify-content-center align-items-center pt-3 pb-4"
        style="background-color: white; margin-top: 60px; width: 100%"
      >
      <!-- back Btn -->
        <div
          class="px-5 pt-4"
          style="position: absolute; top: 111px; left: 25px"
        >
          <button
            type="button"
            class="btn rounded-circle px-0"
            (click)="back()"
            style="
              background-color: #ff4040;
              color: white;
              width: 40px;
              height: 40px;
              padding-top: 8px;
            "
          >
            <span class="material-symbols-outlined"> arrow_back </span>
          </button>
        </div>

        <div
          class="heading d-flex flex-column justify-content-center align-items-center mt-3"
        >
          <h1 class="fw-bold" style="font-size: 33px">{{ userData.name }}</h1>
          <div class="sub-heading">
            <p style="font-size: 18px">
              Phone Number : <span>{{ mobile }}</span>
            </p>
          </div>

          <!-- <div style="font-size: 13px;"><p>Last visited on <span style="font-weight: bold; color:black;">20,March 2024</span> , entries can be seen in following section.</p></div> -->
        </div>

        <div class="py-3" style="width: 100%; text-align: center">
          <button
            type="button"
            class="btn btn1 shadow mx-2"
            (click)="logEnquiry()"
            style="
              color: #ff4040;
              width: 137px;
              height: 37px;
              border-color: #ff4040;
            "
          >
            Log an Enquiry
          </button>
          <!-- <button type="button" class="btn btn1 shadow  mx-2 px-1" style=" color: #ff4040; width: 162px; height: 37px; border-color: #ff4040;">Book an Appointment</button>
        <button type="button" class="btn btn1 shadow  mx-2" style=" color: #ff4040; width: 137px; height: 37px; border-color: #ff4040;">Sale a Service</button> -->
        </div>
      </div>

      <div
        *ngIf="customerHistory.length === 0"
        class="conatiner d-flex flex-column justify-content-center align-items-center pt-3 pb-4"
        style="background-color: white; margin-top: 60px; width: 100%"
      >
        <p
          class="text-center mt-5"
          style="font-size: 18px; margin-bottom: 300px"
        >
          {{ load ? "Loading..." : "" }}
        </p>
      </div>

      <div
        *ngIf="customerHistory.length !== 0"
        class="conatiner d-flex flex-column justify-content-center align-items-center pt-3 pb-4"
        style="background-color: white; margin-top: 60px; width: 100%"
      >
      <!-- heading row -->
        <div
          class="w-100 my-2 px-4 py-2 d-flex justify-content-between"
          style="height: 40px; background-color: #2f3268"
        >
          <div
            class="text-white fw-bold"
            style="width: 8%; font-size: 13px; text-align: center"
          >
            Sr. no.
          </div>
          <div
            class="text-white fw-bold"
            style="width: 18%; font-size: 13px; text-align: center"
          >
            Name
          </div>
          <div
            class="text-white fw-bold"
            style="width: 12%; font-size: 13px; text-align: center"
          >
            Date
          </div>
          <div
            class="text-white fw-bold"
            style="width: 12%; font-size: 13px; text-align: center"
          >
            Enquiry
          </div>
          <div
            class="text-white fw-bold"
            style="width: 12%; font-size: 13px; text-align: center"
          >
            Status
          </div>
          <div
            class="text-white fw-bold"
            style="width: 12%; font-size: 13px; text-align: center"
          >
            Payment
          </div>
          <!-- <div class="text-white fw-bold" style="width: 25%; font-size: 13px; text-align: center;">Last Modified</div> -->
          <div
            class="text-white fw-bold"
            style="width: 26%; font-size: 13px; text-align: center"
          >
            Actions
          </div>
        </div>

        <div
          *ngFor="let hist of customerHistory; let i = index"
          class="w-100 my-2 px-4 py-2 d-flex justify-content-between"
          style="height: 50px"
        >
          <input
            #text
            class="bg-white border border-white text-black"
            value="{{ i + 1 }}"
            style="width: 8%; font-size: 14px; text-align: center"
            disabled
          />
          <input
            #text
            class="bg-white border border-white text-black"
            value="{{ userData.name }}"
            style="width: 18%; font-size: 14px; text-align: center"
            disabled
          />
          <input
            #text
            type="date"
            class="bg-white border border-white text-black"
            [(ngModel)]="this.enqDate[i]"
            style="width: 12%; font-size: 14px; text-align: center"
            disabled
          />
          <input
            #text
            class="bg-white border border-white text-black"
            value="{{ hist.enquiryType }}"
            style="width: 12%; font-size: 14px; text-align: center"
            disabled
          />
          <input
            #text
            class="bg-white border border-white text-black"
            value="pending"
            style="width: 12%; font-size: 14px; text-align: center"
            disabled
          />
          <input
            #text
            class="bg-white border border-white text-black"
            value="pending"
            style="width: 12%; font-size: 14px; text-align: center"
            disabled
          />
          <!-- <div clw-bold" style="width: 25%; font-size: 13px; text-align: center;">Last Modified</div> -->
          <div
            class="d-flex justify-content-evenly"
            style="width: 26%; font-size: 13px"
          >
            <button
              type="button"
              class="btn2 btn p-0"
              style="
                height: 30px;
                font-size: 12px;
                color: green;
                border-color: green;
                width: 18%;
              "
              (click)="openModal(hist)"
            >
              View
            </button>
            <button
              type="button"
              class="btn3 btn p-0"
              [style.background-color]="!isEditable[i] ? '#2f3268' : 'white'"
              [style.color]="!isEditable[i] ? 'white' : '#2f3268'"
              style="
                height: 30px;
                width: 18%;
                font-size: 12px;
                color: #2f3268;
                border-color: #2f3268;
              "
              (click)="toggleEdit(i, hist)"
            >
              Edit
            </button>

            <button
              type="button"
              class="btn4 btn p-0"
              style="
                height: 30px;
                font-size: 12px;
                color: red;
                width: 18%;
                border-color: red;
              "
              (click)="executeEnquiry(hist)"
            >
              Deploy
            </button>
          </div>
        </div>
      </div>
    </div>

    <div
      class="modal"
      tabindex="-1"
      role="dialog"
      [ngStyle]="{ display: display }"
    >
      <div
        class="d-flex justify-content-center"
        role="document"
        style="margin-top: 100px"
      >
        <div
          class="modal-content"
          style="
            width: 806px;
            max-height: 500px;
            overflow: auto;
            border: 1px solid black;
          "
        >
          <p class="text-right mb-0">
            <button
              class="btn fw-bold"
              (click)="onCloseHandled()"
              style="width: 40px"
            >
              X
            </button>
          </p>
          <div class="modal-body py-0">
            <div
              class="conatiner d-flex flex-column justify-content-center align-items-center pt-3 pb-5"
              style="background-color: white; width: 100%"
            >
              <div class="px-5" style="width: 100%">
                <div
                  class="px-2 fw-bold"
                  style="
                    border: 1px solid #ff4040;
                    width: 142px;
                    color: #ff4040;
                    font-size: 14px;
                  "
                >
                  Till now (Latest date)
                </div>
                <div
                  *ngIf="timelineData.length !== 0"
                  class="d-flex gap-5"
                  style="width: 100%; height: 200px"
                >
                  <div class="h-100 d-flex flex-column align-items-center px-3">
                    <div style="border: 1px solid #ff4040; height: 40px"></div>
                    <div
                      class="rounded-circle d-flex flex-column justify-content-center align-items-center"
                      style="
                        width: 100px;
                        height: 100px;
                        background-color: #ff4040;
                      "
                    >
                      <span style="color: white; font-size: 20px">{{
                        timelineData[0].updatedAt == undefined
                          ? this.dateChanger(timelineData[0].createdAt).slice(
                              -2
                            )
                          : this.dateChanger(timelineData[0].updatedAt).slice(
                              -2
                            )
                      }}</span>
                      <span style="color: white; font-size: 20px">May</span>
                    </div>
                    <div style="border: 1px solid #ff4040; height: 60px"></div>
                  </div>
                  <div class="w-100 py-4 ps-4">
                    <div
                      style="font-size: 22px; font-weight: bold; color: #2f3268"
                    >
                      Enquiry : Opened by Shivam
                      <span>| Fullfilled by Shivam</span>
                    </div>
                    <div style="font-size: 14px">
                      <span
                        class="me-4"
                        style="
                          font-size: 14px;
                          color: #ff4040;
                          font-weight: bold;
                        "
                        >{{ timelineData[0].enquiryType }}</span
                      >Interest Level :
                      <span style="color: #ff4040; font-weight: bold">{{
                        timelineData[0].interestLevel
                      }}</span>
                    </div>

                    <div>
                      <span style="font-size: 14px">{{
                        timelineData[0].remarks
                      }}</span>
                    </div>
                    <div>
                      <span style="font-size: 14px">{{
                        timelineData[0].updatedAt == undefined
                          ? this.dateChanger(timelineData[0].createdAt).slice(
                              0,
                              10
                            )
                          : this.dateChanger(timelineData[0].updatedAt).slice(
                              0,
                              10
                            )
                      }}</span>
                    </div>
                  </div>
                </div>
                <section
                  *ngIf="
                    timelineData.length !== 0 &&
                    this.timelineData[0].timeline.length !== 0
                  "
                >
                  <div
                    *ngFor="let time of this.timelineData[0].timeline"
                    class="d-flex gap-5"
                    style="width: 100%; height: 200px"
                  >
                    <div
                      class="h-100 d-flex flex-column align-items-center px-3"
                    >
                      <div
                        style="border: 1px solid #ff4040; height: 40px"
                      ></div>
                      <div
                        class="rounded-circle d-flex flex-column justify-content-center align-items-center"
                        style="
                          width: 100px;
                          height: 100px;
                          background-color: #2f3268;
                        "
                      >
                        <span style="color: white; font-size: 20px">{{
                          time.updatedAt == undefined
                            ? this.dateChanger(time.createdAt).slice(-2)
                            : this.dateChanger(time.updatedAt).slice(-2)
                        }}</span>
                        <span style="color: white; font-size: 20px">May</span>
                      </div>
                      <div
                        style="border: 1px solid #ff4040; height: 60px"
                      ></div>
                    </div>
                    <div class="w-100 py-4 ps-4">
                      <div
                        style="
                          font-size: 22px;
                          font-weight: bold;
                          color: #2f3268;
                        "
                      >
                        Enquiry : Opened by Shivam
                        <span>| Fullfilled by Shivam</span>
                      </div>
                      <div style="font-size: 14px">
                        <span
                          class="me-4 fw-bold"
                          style="font-size: 14px; color: #ff4040"
                          >{{ time.enquiryType }}</span
                        >Interest Level :
                        <span style="color: #ff4040; font-weight: bold">{{
                          time.interestLevel
                        }}</span>
                      </div>

                      <div>
                        <span style="font-size: 14px">{{ time.remarks }}</span>
                      </div>
                      <div>
                        <span style="font-size: 14px">{{
                          time.updatedAt == undefined
                            ? this.dateChanger(time.createdAt).slice(0, 10)
                            : this.dateChanger(time.updatedAt).slice(0, 10)
                        }}</span>
                      </div>
                    </div>
                  </div>
                </section>
                <div
                  class="px-2 fw-bold text-center"
                  style="
                    border: 1px solid #ff4040;
                    width: 160px;
                    color: #ff4040;
                  "
                >
                  Joined on Date
                </div>
              </div>
            </div>
          </div>
          <!-- <div class="modal-footer">
                           <button type="button" class="btn btn-default" (click)="onCloseHandled()" >Close</button>
                         </div> -->
        </div>
      </div>
    </div>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
